package xpertss.crypto.x509;

import java.io.IOException;

import xpertss.crypto.util.*;

/**
 * Represent the CertificatePolicyMap ASN.1 object.
 *
 * @author Amit Kapoor
 * @author Hemma Prafullchandra
 */
public class CertificatePolicyMap {
   private CertificatePolicyId issuerDomain;
   private CertificatePolicyId subjectDomain;

   /**
    * Create a CertificatePolicyMap with the passed CertificatePolicyId's.
    *
    * @param issuer  the CertificatePolicyId for the issuer CA.
    * @param subject the CertificatePolicyId for the subject CA.
    */
   public CertificatePolicyMap(CertificatePolicyId issuer,
                               CertificatePolicyId subject)
   {
      this.issuerDomain = issuer;
      this.subjectDomain = subject;
   }

   /**
    * Create the CertificatePolicyMap from the DER encoded value.
    *
    * @param val the DER encoded value of the same.
    */
   public CertificatePolicyMap(DerValue val) throws IOException
   {
      if (val.tag != DerValue.tag_Sequence) {
         throw new IOException("Invalid encoding for CertificatePolicyMap");
      }
      issuerDomain = new CertificatePolicyId(val.data.getDerValue());
      subjectDomain = new CertificatePolicyId(val.data.getDerValue());
   }

   /**
    * Return the issuer CA part of the policy map.
    */
   public CertificatePolicyId getIssuerIdentifier()
   {
      return (issuerDomain);
   }

   /**
    * Return the subject CA part of the policy map.
    */
   public CertificatePolicyId getSubjectIdentifier()
   {
      return (subjectDomain);
   }

   /**
    * Returns a printable representation of the CertificatePolicyId.
    */
   public String toString()
   {
      String s = "CertificatePolicyMap: [\n"
         + "IssuerDomain:" + issuerDomain.toString()
         + "SubjectDomain:" + subjectDomain.toString()
         + "]\n";

      return (s);
   }

   /**
    * Write the CertificatePolicyMap to the DerOutputStream.
    *
    * @param out the DerOutputStream to write the object to.
    * @throws IOException on errors.
    */
   public void encode(DerOutputStream out) throws IOException
   {
      DerOutputStream tmp = new DerOutputStream();

      issuerDomain.encode(tmp);
      subjectDomain.encode(tmp);
      out.write(DerValue.tag_Sequence, tmp);
   }
}
